<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V BANK</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
</head>
<style>
    #glass {
        background: rgba(255, 255, 255, 0.68);
        border-radius: 16px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(2.6px);
        -webkit-backdrop-filter: blur(2.6px);
        border: 5px solid rgba(100, 97, 97, 0.21);
    }
    .form-control:focus {
        color: black;
        background-color: #fff;
        border: 2px solid #a32981;
        outline: 3px;
        box-shadow: 0 0 0 0 white;
    }
</style>

<body>

    <div class="col-12 col-md-8 col-lg-5 m-auto mt-sm-5 bg-light rounded rounded-4 p-3 shadow">
        <div class="col-3 m-auto p-3">
            <img src="../images/VBANK.ico" class="w-100" alt="">
        </div>
        <h6 class="text-center fw-bold">CREATE AN ACCOUNT WITH US</h6>
        <small id="invalidDetails" class="alert alert-danger text-danger text-center fw-bold m-auto border" style="display: none;"></small>
        <hr>
        <small>Personal Information</small><br>
        <!-- <form action=""> -->
            <div class=" col-12 mt-4">
                <div class="form-floating">
                    <input type="text" id="fname" placeholder="First Name" class="form-control">
                    <label for="fname" class="text-muted">First Name <span class="text-danger">*</span></label>
                </div>
                <small id="invalidFirstname" class="text-danger mb-3"></small>
            </div><br>

            <div class="col-12">
                <div class="form-floating">
                    <input type="text" id="lname" placeholder="Last Name" class="form-control ">
                    <label for="fname" class="text-muted">Last Name <span class="text-danger">*</span></label>
                </div>
                <small id="invalidLastname" class="text-danger mb-3"></small>
            </div><br>

            <div class="col-12">
                <div class="form-floating col-12">
                    <input type="email" id="mail" placeholder="Email" class="form-control">
                    <label for="mail" class="text-muted">Email Address <span class="text-danger">*</span></label>
                </div>
                <small id="invalidEmail" class="text-danger"></small>
            </div><br>

            <div class="col-12">
                <div class="form-floating col-12">
                    <input type="number" id="phone" placeholder="Phone" class="form-control">
                    <label for="phone" class="text-muted">Phone Number<span class="text-danger">*</span></label>
                </div>
                <small id="invalidPhoneNumber" class="text-danger"></small>
            </div><br>

            <div class="col-12">
                <div class="form-floating col-12">
                    <input type="password" id="pass" placeholder="Password" class="form-control">
                    <label for="pass" class="text-muted">Password<span class="text-danger">*</span></label>
                </div>
                <small id="invalidPassword" class="text-danger"></small>
            </div><br>

            <div class="text-center">
                <button class="btn text-light p-3" id="userSignUp" onclick="signUp()" style="background-color: #590140;">CREATE ACCOUNT</button>
            </div>
            <div class="text-center p-2">
                <a href="signin.html" style="color: #a32981;">Already have an account? Sign In</a>
            </div>
        <!-- </form> -->
    </div>
    </div><br>
    <!-- <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
            import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-auth.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries
          
            // Your web app's Firebase configuration
            const firebaseConfig = {
              apiKey: "AIzaSyApZKe_boRxe-phIqq2qZxQUo9gs6FxLxI",
              authDomain: "js-bankapp.firebaseapp.com",
              databaseURL: "https://js-bankapp-default-rtdb.firebaseio.com",
              projectId: "js-bankapp",
              storageBucket: "js-bankapp.appspot.com",
              messagingSenderId: "66919610962",
              appId: "1:66919610962:web:332d89d119bcca1c14fd8b"
            };
          
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const auth = getAuth()

            userSignUp.addEventListener('click', ()=>{
               let email = mail.value
               let password = pass.value

               createUserWithEmailAndPassword (auth, email, password)
                .then((userCredential) => {
                // Signed in 
                const user = userCredential.user;
                console.log(user)
                console.log(user.uid)
                // window.location="dashboard.html"
                // ...
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.log(errorMessage)
                // ..
            });
            })
        </script> -->


    <script>

        var allUsers = []
        let accNo = (Math.floor(Math.random() * 1000000000 - 9000000000) + 1000000000) * -1
        let myBvn = (Math.floor(Math.random() * 10000000000 - 90000000000) + 10000000000) * -1
        let prac = Math.random()
        let res = prac * 1000
        let validFirstName = false
        let validLastname = false
        let validEmail = false
        let validPhoneNumber = false
        let validPassword = false
        console.log(prac)
        console.log(res)
        console.log(accNo)
        console.log(myBvn)

        if (localStorage.usersList) {
            allUsers = JSON.parse(localStorage.getItem("usersList"))
        } else {
            allUsers = []
        }
        fname.addEventListener('blur', () => {
            let validateName = /^([a-z A-Z]{3,10})+$/
            validateFirstName = validateName.test(fname.value)
            if (validateFirstName) {
                validFirstName = true
                console.log(validateFirstName)
                invalidFirstname.innerText = ""
                fname.classList.remove("is-invalid")
                fname.classList.add("is-valid")
            } else {
                validFirstName = false
                fname.classList.remove("is-valid")
                fname.classList.add("is-invalid")
                invalidFirstname.innerText = "Invalid FirstName (Firstname must contain only letters and minimum of three charecters)"
                console.log(validateFirstName)
            }
        })
        lname.addEventListener('blur', () => {
            let validateName = /^([a-z A-Z]{3,10})+$/
            validateLastName = validateName.test(lname.value)
            if (validateLastName) {
                validLastname = true
                console.log(validateFirstName)
                invalidLastname.innerText = ""
                lname.classList.remove("is-invalid")
                lname.classList.add("is-valid")
                invalidLastname.innerText = ""
            } else {
                validLastname = false
                lname.classList.remove("is-valid")
                lname.classList.add("is-invalid")
                invalidLastname.innerText = "Invalid LastName (Lastname must contain only letters and minimum of three charecters)"
                console.log()
            }
        })
        mail.addEventListener("blur", () => {
            let validateEmail = /^([a-z]+)([0-9]+)?([.][\w]+)?([@])([a-z]+)([.])([a-z]{1,7})([.][a-z]{1,7})?$/
            let checkEmailValidation = validateEmail.test(mail.value)
            if (checkEmailValidation) {
                validEmail = true
                console.log(checkEmailValidation)
                mail.classList.remove('is-invalid')
                mail.classList.add('is-valid')
                invalidEmail.innerText=""
            } else {
                validEmail = false
                mail.classList.remove('is-valid')
                mail.classList.add('is-invalid')
                invalidEmail.innerText="Email is Invalid (E-mail must contain only lowercase characters)"
                console.log(checkEmailValidation)
            }
        })
        phone.addEventListener("blur", () => {
            let validatePhone = /^[0-9]{5,11}$/
            let checkPhoneValidation = validatePhone.test(phone.value)
            if (checkPhoneValidation) {
                validPhoneNumber = true
                invalidPhoneNumber.innerText=""
                phone.classList.remove('is-invalid')
                phone.classList.add('is-valid')
            } else {
                validPhoneNumber = false
                phone.classList.remove('is-valid')
                phone.classList.add('is-invalid')
                console.log(checkPhoneValidation)
            }
        })
        pass.addEventListener("blur", () => {
            let validatePassword = /^[\w]{3,10}$/
            let checkPasswordValidation = validatePassword.test(pass.value)
            if (checkPasswordValidation) {
                validPassword = true
                invalidPassword.innerText=""
                pass.classList.remove('is-invalid')
                pass.classList.add('is-valid')
            } else {
                validPassword = false
                invalidPassword.innerText="Password must be at lest 4 characters"
                pass.classList.remove('is-valid')
                pass.classList.add('is-invalid')
                console.log(checkPasswordValidation)
            }
        })
        const signUp = () => {
            if (validFirstName && validLastname && validEmail) {
                let userDetails = {
                    firstname: fname.value,
                    lastname: lname.value,
                    email: mail.value,
                    phoneNo: phone.value,
                    bvn: myBvn,
                    password: pass.value,
                    accountbalance: 1000,
                    accountnumber: accNo,
                    transactionPin: 1234,
                    profilePhoto: "",
                    firstTimeLogin: true
                }
                allUsers.push(userDetails)
                console.log(allUsers)
                fname.value = ""
                lname.value = ""
                mail.value = ""
                phone.value = ""
                pass.value = ""
                localStorage.setItem("usersList", JSON.stringify(allUsers))
                window.location = "signin.html"
            } else {
                if (fname.value==""){
                    invalidFirstname.innerText="Firstname is required"
                } 
                if (lname.value==""){
                    invalidLastname.innerText="Lastname is required"
                } 
                if (mail.value==""){
                    invalidEmail.innerText="Email is required"
                } 
                if (phone.value==""){
                    invalidPhoneNumber.innerText="Phone Number is required"
                } 
                if (pass.value==""){
                    invalidPassword.innerText="Password is required"
                } 
                invalidDetails.style.display="block"
                invalidDetails.innerText="Kindly fill all detalis"
            }
        }
    </script>
</body>

</html>